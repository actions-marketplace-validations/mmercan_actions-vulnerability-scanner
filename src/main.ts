import * as core from '@actions/core'
import { NugetExtract, QueryVulnerabilities, ReportToConsole } from 'vulnerability-scanner';

async function run(): Promise<void> {
  try {
    const filePath = core.getInput('path')
   
    const tt = new NugetExtract(filePath);
    const query = new QueryVulnerabilities();
    await query.QueryAllPackages(tt.projects);

    ReportToConsole(tt.projects);
 
    core.warning(new Date().toTimeString())

    core.setOutput('time', new Date().toTimeString())
  } catch (error) {
    if (error instanceof Error) core.setFailed(error.message)
  }
}

run()
